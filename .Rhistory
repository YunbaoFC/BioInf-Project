matrix.type = "adjacency",
ignore.eval = FALSE,
names.eval = "weights",
directed = FALSE
)
# --- Network analysis ---
network.density(net.z)
biogrid <- read.delim("BIOGRID-ORGANISM-Homo_sapiens-5.0.252.tab3.txt")
!ls
ls
getwd()
setwd("Bureau/Sapienza") # <- Modify this
getwd()
setwd("Bureau/Sapienza") # <- Modify this
getwd()
setwd("Bureau/Sapienza/BioInf/") # <- Modify this
getwd()
setwd("BioInf/BioInf-Project") # <- Modify this
getwd()
# setwd("Bureau/Sapienza/BioInf/BioInf-Project") # <- Modify this
getwd() # <- To check you're in the right directory
biogrid <- read.delim("BIOGRID-ORGANISM-Homo_sapiens-5.0.252.tab3.txt")
# setwd("Bureau/Sapienza/BioInf/BioInf-Project") # <- Modify this
getwd() # <- To check you're in the right directory
human_interactions <- subset(
biogrid,
Organism.ID.Interactor.A == 9606 &
Organism.ID.Interactor.B == 9606
)
View(human_interactions)
human_interactions <- subset(
biogrid,
Organism.ID.Interactor.A == 9606 &
Organism.ID.Interactor.B == 9606 &
Experimental.Systel.Type == "physical"
)
human_interactions <- subset(
biogrid,
Organism.ID.Interactor.A == 9606 &
Organism.ID.Interactor.B == 9606 &
Experimental.System.Type == "physical"
)
ppi_edges <- human_interactions[, c("Official.Symbol.Interactor.A", "Official.Symbol.Interactor.B")]
head(ppi_edges)
View(ppi_edges)
getwd()
# setwd("Bureau/Sapienza/BioInf/BioInf-Project") # <- Modify this
getwd() # <- To check you're in the right directory
# Read the original file
biogrid <- read.delim("BIOGRID-ORGANISM-Homo_sapiens-5.0.252.tab3.txt")
# Filter what we want to get
human_interactions <- subset(
biogrid,
Organism.ID.Interactor.A == 9606 &
Organism.ID.Interactor.B == 9606 &
Experimental.System.Type == "physical"
)
# Only keep the 2 columns Official.Symbol.Interactor A and B
ppi_edges <- human_interactions[, c("Official.Symbol.Interactor.A", "Official.Symbol.Interactor.B")]
# Export to txt file
write.table(
ppi_edges,
file = "ppi_edges_human.txt",
sep = "\t",           # tabulation
row.names = FALSE,    # no line number
quote = FALSE         # no quotes in text
)
View(ppi_edges)
getwd()
# Read the original file
biogrid <- read.delim("ppi_edges_human.txt")
View(biogrid)
# 1.1 Read BIOGRID Human Interactome
biogrid <- read.delim("ppi_edges_human.txt")
# 1.1 Read BIOGRID Human Interactome
biogrid <- read.delim("Files/ppi_edges_human.txt")
getwd()
# setwd("Bureau/Sapienza/BioInf/BioInf-Project") # <- Modify this
getwd() # <- To check you're in the right directory
# Read the original file
biogrid <- read.delim("Files/BIOGRID-ORGANISM-Homo_sapiens-5.0.252.tab3.txt")
# Filter what we want to get
human_interactions <- subset(
biogrid,
Organism.ID.Interactor.A == 9606 &
Organism.ID.Interactor.B == 9606 &
Experimental.System.Type == "physical"
)
# Only keep the 2 columns Official.Symbol.Interactor A and B
ppi_edges <- human_interactions[, c("Official.Symbol.Interactor.A", "Official.Symbol.Interactor.B")]
# Export to txt file
write.table(
ppi_edges,
file = "Files/ppi_edges_human.txt",
sep = "\t",           # tabulation
row.names = FALSE,    # no line number
quote = FALSE         # no quotes in text
)
getwd()
# setwd("Bureau/Sapienza/BioInf/BioInf-Project") # <- Modify this
getwd() # <- To check you're in the right directory
# 1.1 Read BIOGRID Human Interactome
biogrid <- read.delim("Files/ppi_edges_human.txt")
View(biogrid)
# 1.2 Read Huri
huri <- read.delim("Files/HI-union.tsv")
View(huri)
# Libraries
library(gprofiler2)
install.packages(gprofiler2)
################################################################################
# 2. Translate Huri Genes Ensemble ID into Genes Symbols
################################################################################
library(biomaRt)
ensembl <- useMart("ensembl", dataset = "hsapiens_gene_ensembl") # Connect to Ensembl
huri <- read.delim("Files/HI-union.tsv") # Load original file
all_genes <- unique(c(ppi_edges$GeneA, ppi_edges$GeneB)) # Get IDs
# biomaRt request
gene_map <- getBM(
attributes = c("ensembl_gene_id", "hgnc_symbol"),
filters = "ensembl_gene_id",
values = all_genes,
mart = ensembl
)
head(huri)
colnames(huri) <- c("GeneA", "GeneB")
# biomaRt request
gene_map <- getBM(
attributes = c("ensembl_gene_id", "hgnc_symbol"),
filters = "ensembl_gene_id",
values = all_genes,
mart = ensembl
)
head(huri)
huri <- read.delim("Files/HI-union.tsv", header = FALSE, stringsAsFactors = FALSE) # Load original file
colnames(huri) <- c("GeneA", "GeneB")
head(huri)
ensembl <- useMart("ensembl", dataset = "hsapiens_gene_ensembl") # Connect to Ensembl
all_genes <- unique(c(ppi_edges$GeneA, ppi_edges$GeneB)) # Get IDs
# biomaRt request
gene_map <- getBM(
attributes = c("ensembl_gene_id", "hgnc_symbol"),
filters = "ensembl_gene_id",
values = all_genes,
mart = ensembl
)
all_genes <- unique(c(huri$GeneA, huri$GeneB)) # Get IDs
# biomaRt request
gene_map <- getBM(
attributes = c("ensembl_gene_id", "hgnc_symbol"),
filters = "ensembl_gene_id",
values = all_genes,
mart = ensembl
)
# Replace in table
translate_genes <- function(ids, map) {
sapply(ids, function(x) {
sym <- map$hgnc_symbol[map$ensembl_gene_id == x]
if(length(sym) == 0 || sym == "") x else sym
})
}
huri$GeneA <- translate_genes(ppi_edges$GeneA, gene_map)
huri$GeneA <- translate_genes(huri$GeneA, gene_map)
huri$GeneB <- translate_genes(huri$GeneB, gene_map)
head(huri)
View(huri)
huri <- read.delim("Files/HI-union.tsv", header = FALSE, stringsAsFactors = FALSE) # Load original file
View(huri)
colnames(huri) <- c("GeneA", "GeneB")
ensembl <- useMart("ensembl", dataset = "hsapiens_gene_ensembl") # Connect to Ensembl
all_genes <- unique(c(huri$GeneA, huri$GeneB)) # Get IDs
# biomaRt request
gene_map <- getBM(
attributes = c("ensembl_gene_id", "hgnc_symbol"),
filters = "ensembl_gene_id",
values = all_genes,
mart = ensembl
)
# Replace in table
translate_genes <- function(ids, map) {
sapply(ids, function(x) {
sym <- map$hgnc_symbol[map$ensembl_gene_id == x]
if(length(sym) == 0 || sym == "") x else sym
})
}
head(huri)
View(huri)
huri$GeneA <- translate_genes(huri$GeneA, gene_map)
View(huri)
huri$GeneB <- translate_genes(huri$GeneB, gene_map)
head(huri)
View(huri)
# Write new file
write.table(huri, "Files/huri_symbols", sep = "\t", row.names = FALSE, quote = FALSE)
# 1.2 Read Huri
huri <- read.delim("Files/huri_symbols.txt")
# Write new file
write.table(huri, "Files/huri_symbols.txt", sep = "\t", row.names = FALSE, quote = FALSE)
# 1.2 Read Huri
huri <- read.delim("Files/huri_symbols.txt")
View(huri)
# Read the original file
biogrid <- read.delim("Files/Original_files/BIOGRID-ORGANISM-Homo_sapiens-5.0.252.tab3.txt")
huri <- read.delim("Files/Original_files/HI-union.tsv", header = FALSE, stringsAsFactors = FALSE) # Load original file
################################################################################
# 3. Filter String
################################################################################
String <- read.delim("Files/Original_files/9606.protein.links.v12.0.onlyAB.txt")
View(String)
################################################################################
# 3. Filter String + Translate
################################################################################
library(tidyr)
String_sep <- separate(String, col = V1, into = c("ProteinA", "ProteinB", "Score"), sep = " ")
String_sep <- separate(String, col = "protein1.protein2.combined_score", into = c("ProteinA", "ProteinB", "Score"), sep = " ")
View(String_sep)
# Clean IDs
String_sep$ProteinA <- sub("^9606\\.", "", String_sep$ProteinA)
String_sep$ProteinB <- sub("^9606\\.", "", String_sep$ProteinB)
# Unique vectors
all_genes <- unique(c(String_sep$ProteinA, String_sep$ProteinB))
# Unique vectors
all_genes_string <- unique(c(String_sep$ProteinA, String_sep$ProteinB))
# biomaRt request
gene_map <- getBM(
attributes = c("ensembl_peptide_id", "hgnc_symbol"),
filters = "ensembl_peptide_id",
values = all_genes_string,
mart = ensembl
)
# Translate in table
String_sep$ProteinA <- translate_genes(String_sep$ProteinA, gene_map)
String_sep$ProteinB <- translate_genes(String_sep$ProteinB, gene_map)
View(String_sep)
# Unique vectors
all_genes_string <- unique(c(String_sep$ProteinA, String_sep$ProteinB))
# biomaRt request
gene_map <- getBM(
attributes = c("ensembl_peptide_id", "hgnc_symbol"),
filters = "ensembl_peptide_id",
values = all_genes_string,
mart = ensembl
)
# Translate in table
String_sep$ProteinA <- translate_genes(String_sep$ProteinA, gene_map)
################################################################################
# 3. Filter Reactome
################################################################################
Reactome <- read.delim("Files/Original_files/FIsInGene_04142025_with_annotations.txt")
###############################################################################
# Function to convert from Genes Ensembl -> Genes Symbol
###############################################################################
ensembl <- useMart("ensembl", dataset = "hsapiens_gene_ensembl") # Connect to Ensembl
translate_genes <- function(ids, map) {
sapply(ids, function(x) {
sym <- map$hgnc_symbol[map$ensembl_gene_id == x]
if(length(sym) == 0 || sym == "") x else sym
})
}
# Unique vectors
all_genes_string <- unique(c(String_sep$ProteinA, String_sep$ProteinB))
# biomaRt request
gene_map <- getBM(
attributes = c("ensembl_peptide_id", "hgnc_symbol"),
filters = "ensembl_peptide_id",
values = all_genes_string,
mart = ensembl
)
# Translate in table
String_sep$ProteinA <- translate_genes(String_sep$ProteinA, gene_map)
View(String_sep)
gene_map <- getBM(
attributes = c("ensembl_peptide_id", "hgnc_symbol"),
filters = "ensembl_peptide_id",
values = all_genes,
mart = ensembl
)
# Fonction pour traduire un vecteur
translate_genes <- function(ids, map) {
sapply(ids, function(x) {
sym <- map$hgnc_symbol[map$ensembl_peptide_id == x]
if(length(sym) == 0 || sym == "") x else sym
})
}
# Translate in table
String_sep$ProteinA <- translate_genes(String_sep$ProteinA, gene_map)
# Unique vectors
all_genes_string <- unique(c(String_sep$ProteinA, String_sep$ProteinB))
# biomaRt request
gene_map <- getBM(
attributes = c("ensembl_peptide_id", "hgnc_symbol"),
filters = "ensembl_peptide_id",
values = all_genes_string,
mart = ensembl
)
# Fonction pour traduire un vecteur
translate_genes <- function(ids, map) {
sapply(ids, function(x) {
sym <- map$hgnc_symbol[map$ensembl_peptide_id == x]
if(length(sym) == 0 || sym == "") x else sym
})
}
# Translate in table
String_sep$ProteinA <- translate_genes(String_sep$ProteinA, gene_map)
View(String_sep)
View(Huri)
View(huri)
View(ppi_edges)
View(ppi_edges)
View(Reactome)
################################################################################
# 3. Filter Reactome
################################################################################
Reactome <- read.delim("Files/Original_files/FIsInGene_04142025_with_annotations.txt")
reactome_genes <- subset(Reactome, select = c(Gene1, Gene2))
View(Reactome)
View(reactome_genes)
write.table(reactome_genes, "Files/Reactome.txt", sep = "\t", row.names = FALSE, quote = FALSE)
# biomaRt request
gene_map <- getBM(
attributes = c("ensembl_peptide_id", "hgnc_symbol"),
filters = "ensembl_peptide_id",
values = all_genes_string,
mart = ensembl
)
# Unique vectors
all_genes_string <- unique(c(String_sep$ProteinA, String_sep$ProteinB))
# biomaRt request
gene_map <- getBM(
attributes = c("ensembl_peptide_id", "hgnc_symbol"),
filters = "ensembl_peptide_id",
values = all_genes_string,
mart = ensembl
)
# Translate in table
String_sep$ProteinA <- translate_peptide(String_sep$ProteinA, gene_map)
translate_peptide <- function(ids, map) {
sapply(ids, function(x) {
sym <- map$hgnc_symbol[map$ensembl_peptide_id == x]
if(length(sym) == 0 || sym == "") x else sym
})
}
# Translate in table
String_sep$ProteinA <- translate_peptide(String_sep$ProteinA, gene_map)
String_sep$ProteinB <- translate_peptide(String_sep$ProteinB, gene_map)
# Write new table
write.table(String_sep, "Files/String.txt", sep = "\t", row.names = FALSE, quote = FALSE)
View(String_sep)
write.table(String_sep, "Files/String.txt", sep = "\t", row.names = FALSE, quote = FALSE)
write.table(reactome_genes, "Files/Reactome.txt", sep = "\t", row.names = FALSE, quote = FALSE)
################################################################################
# 4. Clean redundant interactions + self loops
################################################################################
library(igraph)
make_LCC <- function(df) {
# Rename column names
colnames(df)[1:2] <- c("GeneA", "GeneB")
# Graph
g <- graph_from_data_frame(df, directed = FALSE)
# Suppr self-loops + doubles
if ("Score" %in% colnames(df)) {
g <- simplify(
g,
remove.loops = TRUE,
edge.attr.comb = list(Score = "max")
)
} else {
g <- simplify(
g,
remove.loops = TRUE,
remove.multiple = TRUE
)
}
# Extract Largest Connected Component
comps <- components(g)
lcc_id <- which.max(comps$csize)
g_lcc <- induced_subgraph(
g,
vids = V(g)[comps$membership == lcc_id]
)
return(g_lcc)
}
g_biogrid <- make_LCC(ppi_edges[, c("ProteinA", "ProteinB", "Score")],directed = FALSE)
g_string <- make_LCC(String_sep[, c("ProteinA", "ProteinB", "Score")],directed = FALSE)
g_reactome <- make_LCC(reactome_genes[, c("ProteinA", "ProteinB", "Score")],directed = FALSE)
g_huri <- make_LCC(huri[, c("ProteinA", "ProteinB", "Score")],directed = FALSE)
head (ppi_edges)
g_biogrid <- make_LCC(ppi_edges[, c("Official.Symbol.Interactor.A", "Official.Symbol.Interactor.B")],directed = FALSE)
g_biogrid <- make_LCC(ppi_edges[, c("Official.Symbol.Interactor.A", "Official.Symbol.Interactor.B")])
head (huri)
g_huri <- make_LCC(huri[, c("V1", "V2", "Score")])
g_huri <- make_LCC(huri[, c("V1", "V2")])
return(String_sep)
head (String_sep)
g_string <- make_LCC(String_sep[, c("ProteinA", "ProteinB", "Score")])
head (reactome_genes)
g_reactome <- make_LCC(reactome_genes[, c("Gene1", "Gene2")])
g_biogrid <- clean_interactome(ppi_edges[, c("Official.Symbol.Interactor.A", "Official.Symbol.Interactor.B")])
df <- df[!duplicated(df$pair_id), ]
clean_interactome <- function(df,
colA = 1,
colB = 2,
score_col = NULL) {
# Rename columns
df <- df[, c(colA, colB, score_col), drop = FALSE]
colnames(df)[1:2] <- c("GeneA", "GeneB")
#if (!is.null(score_col)) colnames(df)[3] <- "Score"
# Surp les self-loops
df <- df[df$GeneA != df$GeneB, ]
# Supr doubles
df$pair_id <- apply(df[, c("GeneA", "GeneB")], 1, function(x)
paste(sort(x), collapse = "_"))
if (!is.null(score_col)) {
df <- aggregate(Score ~ pair_id + GeneA + GeneB,
data = df,
FUN = max)
} else {
df <- df[!duplicated(df$pair_id), ]
}
df$pair_id <- NULL
# Get graph
g <- graph_from_data_frame(df, directed = FALSE)
# Get only LCC
comp <- components(g)
lcc_id <- which.max(comp$csize)
g_lcc <- induced_subgraph(
g,
vids = V(g)[comp$membership == lcc_id]
)
# Filter Table for LCC
lcc_nodes <- V(g_lcc)$name
df_lcc <- df[
df$GeneA %in% lcc_nodes &
df$GeneB %in% lcc_nodes, ]
return(list(
table_full_clean = df,
table_LCC = df_lcc,
graph_LCC = g_lcc
))
}
head (reactome_genes)
g_biogrid <- clean_interactome(ppi_edges[, c("Official.Symbol.Interactor.A", "Official.Symbol.Interactor.B")])
list(df_biogrif, df_lcc_, g_lcc_biogrid) <- clean_interactome(ppi_edges[, c("Official.Symbol.Interactor.A", "Official.Symbol.Interactor.B")])
list(df_biogrid, df_lcc_biogrid, g_lcc_biogrid) <- clean_interactome(ppi_edges[, c("Official.Symbol.Interactor.A", "Official.Symbol.Interactor.B")])
biogrid <- clean_interactome(ppi_edges[, c("Official.Symbol.Interactor.A", "Official.Symbol.Interactor.B")])
biogrid
write.table(huri, "Files/Huri.txt", sep = "\t", row.names = FALSE, quote = FALSE)
huri <- clean_interactome(huri[, c("V1", "V2")])
string <- clean_interactome(String_sep[, c("ProteinA", "ProteinB", "Score")])
reactome <- clean_interactome(reactome_genes[, c("Gene1", "Gene2")])
View(string$table_full_clean)
View(string$table_LCC)
View(string$graph_LCC)
View(huri$table_full_clean)
View(huri$table_LCC)
View(biogrid$table_full_clean)
View(biogrid$table_LCC)
View(reactome$table_full_clean)
View(reactome$table_LCC)
# Write new files
write.table(biogrid$table_LCC,file = "Files/Biogrid.txt",sep = "\t",row.names = FALSE,quote = FALSE)
write.table(huri$table_LCC, "Files/Huri.txt", sep = "\t", row.names = FALSE, quote = FALSE)
write.table(string$table_LCC, "Files/String.txt", sep = "\t", row.names = FALSE, quote = FALSE)
write.table(reactome$table_LCC, "Files/Reactome.txt", sep = "\t", row.names = FALSE, quote = FALSE)
# 1.1 Read BIOGRID Human Interactome
biogrid <- read.delim("Files/Biogrid.txt")
View(biogrid)
View(reactome$table_full_clean)
# 1.2 Read Huri
huri <- read.delim("Files/Huri.txt")
View(huri)
# 1.3 Read String
String <- read.delim("Files/String.txt")
View(String)
# 1.4 Read Reactome
reactome <- read.delim("Files/Reactome.txt")
View(reactome)
################################################################################
# 5. Filter Cardiomyopathy file
################################################################################
Cardiomyopathy <- read.delim("Files/Original_files/diseases_.tsv")
Vies(Cardiomyopathy)
View(Cardiomyopathy)
Cardiomyopathy <- subset(Cardiomyopathy, select = c(Associated.Genes))
Cardiomyopathy <- subset(Cardiomyopathy, select = c(Associated.genes))
colnames(Cardiomyopathy) <- c("Genes")
View(Cardiomyopathy)
################################################################################
# 5. Filter Cardiomyopathy file
################################################################################
Cardiomyopathy <- read.delim("Files/Original_files/diseases_.tsv")
View(Cardiomyopathy)
write.table(Cardiomyopathy,file = "Files/Cardiomyopathy.txt",sep = "\t",row.names = FALSE,quote = FALSE)
# 1.4 Cardiomyopathy
reactome <- read.delim("Files/Cardiomyopathy.txt")
View(reactome)
################################################################################
# 5. Filter Cardiomyopathy file
################################################################################
Cardiomyopathy <- read.delim("Files/Original_files/diseases_.tsv")
Cardiomyopathy <- subset(Cardiomyopathy, select = c(Associated.genes))
colnames(Cardiomyopathy) <- c("Genes")
head(Cardiomyopathy)
write.table(Cardiomyopathy,file = "Files/Cardiomyopathy.txt",sep = "\t",row.names = FALSE,quote = FALSE)
# 1.4 Cardiomyopathy
cardiomyopathy <- read.delim("Files/Cardiomyopathy.txt")
View(cardiomyopathy)
View(cardiomyopathy)
cardiomyopathy
head(cardiomyopathy)
cardiomyopathy[0]
cardiomyopathy[1]
